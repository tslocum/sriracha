version: 2
project_name: sriracha
builds:
  -
    id: bbcode
    buildmode: plugin
    main: ./plugin/bbcode/
    binary: ./plugin/bbcode.so
    ldflags:
      - -s -w -X codeberg.org/tslocum/sriracha.SrirachaVersion={{.Version}}
    goos:
      - linux
    goarch:
      - amd64
  -
    id: fortune
    buildmode: plugin
    main: ./plugin/fortune/
    binary: ./plugin/fortune.so
    ldflags:
      - -s -w -X codeberg.org/tslocum/sriracha.SrirachaVersion={{.Version}}
    goos:
      - linux
    goarch:
      - amd64
  -
    id: robot9000
    buildmode: plugin
    main: ./plugin/robot9000/
    binary: ./plugin/robot9000.so
    ldflags:
      - -s -w -X codeberg.org/tslocum/sriracha.SrirachaVersion={{.Version}}
    goos:
      - linux
    goarch:
      - amd64
  -
    id: wordfilter
    buildmode: plugin
    main: ./plugin/wordfilter/
    binary: ./plugin/wordfilter.so
    ldflags:
      - -s -w -X codeberg.org/tslocum/sriracha.SrirachaVersion={{.Version}}
    goos:
      - linux
    goarch:
      - amd64
  -
    id: sriracha
    main: ./cmd/sriracha/
    ldflags:
      - -s -w -X codeberg.org/tslocum/sriracha.SrirachaVersion={{.Version}}
    goos:
      - darwin
      - freebsd
      - linux
    goarch:
      - amd64
archives:
  -
    ids:
      - sriracha
      - bbcode
      - fortune
      - robot9000
      - wordfilter
    wrap_in_directory: sriracha
    allow_different_binary_count: true
    name_template: >-
      {{- .ProjectName }}_
      {{- .Version }}_
      {{- tolower .Os }}_
      {{- if eq .Arch "386" }}i386{{ else }}
      {{- tolower .Arch }}{{ end -}}
    files:
      - ./*.md
      - CHANGELOG
      - LICENSE
checksum:
  name_template: 'checksums.txt'
